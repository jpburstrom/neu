#N canvas 450 139 904 390 10;
#X obj 176 -72 ctlin;
#X obj 176 32 pack 0 0 0;
#X obj 155 163 t b a;
#X obj 175 144 t a a a;
#X obj 214 177 s \$1-PRECTLIN;
#X obj 193 201 s \$1-CTLIN;
#X obj 175 225 s \$1-POSTCTLIN;
#X obj 176 79 spigot 1;
#X obj 286 35 inlet;
#X text 427 142 A singleton abstraction \, supposed to be put somewhere
in your patch. Sends ctlin data to the other abstractions sharing the
same first argument.;
#X obj 24 25 pack 0 0 0;
#X obj 177 5 spigot;
#X obj 27 156 print FO;
#N canvas 0 0 694 510 nrpnin 0;
#X text 166 510 value;
#X text 210 489 parameter;
#X msg 120 72 \$3 \$2 \$1;
#X obj 120 97 route \$2;
#X text 243 67 if no midi channel specified \, omni;
#X msg 163 147 \$2 \$3;
#X obj 120 508 outlet;
#X obj 163 486 outlet;
#X msg 202 147 \$1;
#X obj 121 305 unpack f f;
#X obj 202 463 outlet;
#X text 251 462 channel;
#N canvas 0 0 787 696 \$0-filter_proper_input 0;
#X obj 127 475 pack f f f f f f f f;
#X obj 127 310 pack f f f;
#X msg 127 335 \$3 \$1 \$2;
#X obj 127 422 unpack;
#X obj 167 422 unpack;
#X obj 207 422 unpack;
#X obj 127 395 route 1 2 3 4;
#X obj 127 232 spigot;
#X msg 184 204 0;
#X msg 158 204 1;
#X obj 184 129 t f f;
#X obj 184 173 sel 38;
#X obj 127 523 route 38;
#X obj 127 544 route 6;
#X obj 127 565 route 98;
#X obj 127 586 route 99;
#X msg 127 498 \$1 \$3 \$5 \$7 \$8 \$6 \$4 \$2;
#X obj 121 35 route 99;
#X obj 121 66 t f b b;
#X obj 184 100 unpack;
#X obj 34 315 pack f 99;
#X msg 34 339 4 \$2 \$1;
#X obj 127 357 t l b;
#X obj 121 7 inlet;
#X obj 127 613 outlet;
#X obj 250 422 unpack;
#X text 332 307 When Ctl 99 is receive it is prepended with a 4 \,
all subsequent controller values in are prepended with a 3 \, 2 \,
1;
#X text 334 407 The pairs are then ordered according to their prepended
value. The pair prepended with 1 will be the last of the four pairs
to arrive and will trigger the pack to send the data.;
#X text 335 498 The list in reordered to have all the controller numbers
first \, and all the values following that. In the order initially
received.;
#X text 338 563 They are then routed in sequence to ensure that they
do follow the standard for NRPN values (99 \, 98 \, 6 \, 38).;
#X msg 183 266 3;
#X obj 183 288 f;
#X obj 218 289 - 1;
#X connect 0 0 16 0;
#X connect 1 0 2 0;
#X connect 2 0 22 0;
#X connect 3 0 0 0;
#X connect 3 1 0 1;
#X connect 4 0 0 2;
#X connect 4 1 0 3;
#X connect 5 0 0 4;
#X connect 5 1 0 5;
#X connect 6 0 3 0;
#X connect 6 1 4 0;
#X connect 6 2 5 0;
#X connect 6 3 25 0;
#X connect 7 0 1 0;
#X connect 8 0 7 1;
#X connect 9 0 7 1;
#X connect 10 0 11 0;
#X connect 10 1 7 0;
#X connect 11 0 8 0;
#X connect 12 0 13 0;
#X connect 13 0 14 0;
#X connect 14 0 15 0;
#X connect 15 0 24 0;
#X connect 16 0 12 0;
#X connect 17 0 18 0;
#X connect 17 1 19 0;
#X connect 18 0 20 0;
#X connect 18 1 30 0;
#X connect 18 2 9 0;
#X connect 19 0 10 0;
#X connect 19 1 1 1;
#X connect 20 0 21 0;
#X connect 21 0 6 0;
#X connect 22 0 6 0;
#X connect 22 1 31 0;
#X connect 23 0 17 0;
#X connect 25 0 0 6;
#X connect 25 1 0 7;
#X connect 30 0 31 0;
#X connect 31 0 1 2;
#X connect 31 0 32 0;
#X connect 32 0 31 1;
#X restore 120 186 pd \$0-filter_proper_input;
#N canvas 0 0 568 312 \$0-MSB_and_LSB 0;
#X obj 79 78 unpack f f f f;
#X obj 131 149 +;
#X obj 79 148 +;
#X obj 79 114 * 128;
#X obj 131 113 * 128;
#X obj 79 180 pack f f;
#X obj 79 47 inlet;
#X obj 79 250 outlet;
#X text 218 82 All that's left is the MSB and LSB values for the parameter
\, and the parameter value. These are used to calculate the parameter
and parameter value;
#X connect 0 0 3 0;
#X connect 0 1 2 1;
#X connect 0 2 4 0;
#X connect 0 3 1 1;
#X connect 1 0 5 1;
#X connect 2 0 5 0;
#X connect 3 0 2 0;
#X connect 4 0 1 0;
#X connect 5 0 7 0;
#X connect 6 0 0 0;
#X restore 120 214 pd \$0-MSB_and_LSB;
#X obj 120 49 inlet;
#X obj 163 120 spigot 1;
#X msg 123 257 \$2 \$1;
#X connect 2 0 3 0;
#X connect 3 0 12 0;
#X connect 3 1 15 0;
#X connect 5 0 12 0;
#X connect 8 0 10 0;
#X connect 9 0 6 0;
#X connect 9 1 7 0;
#X connect 12 0 13 0;
#X connect 13 0 16 0;
#X connect 14 0 2 0;
#X connect 15 0 5 0;
#X connect 15 0 8 0;
#X connect 16 0 9 0;
#X restore 22 -54 pd nrpnin;
#X obj 134 -45 t a a;
#X obj 22 -74 pack 0 0 0;
#X obj 53 4 + 1000;
#X obj 189 -51 t a a;
#X text -16 124 NRPN values are offset by 1000 If you use these cc
6 98 99 and 38 are unusable.;
#X text 423 265 Johannes Burström 2009;
#X obj 176 103 spigot 1;
#X obj 244 94 expr if ($f2 != 0 \, $f1 == $f2 \, 1);
#X obj 554 -49 f \$2;
#X obj 604 -66 loadbang;
#X obj 450 67 f \$3;
#X obj 221 -27 expr if ($f2 != 0 \, $f1 != 6 && $f1 != 38 && $f1 !=
98 && $f1 != 99 \, 1 );
#X text 428 185 2nd argument: NRPN mode (0/1) \; 3rd argument: Midi
channel (0=omni);
#X obj 12 199 r \$1-CTLOUT;
#X obj 12 247 ctlout 0 \$3;
#X connect 0 0 14 0;
#X connect 0 1 15 1;
#X connect 0 1 17 0;
#X connect 0 2 1 2;
#X connect 0 2 15 2;
#X connect 0 2 21 0;
#X connect 1 0 7 0;
#X connect 2 1 6 0;
#X connect 3 0 2 0;
#X connect 3 1 5 0;
#X connect 3 2 4 0;
#X connect 7 0 20 0;
#X connect 8 0 7 1;
#X connect 10 0 7 0;
#X connect 11 0 1 0;
#X connect 13 0 10 0;
#X connect 13 1 16 0;
#X connect 13 2 10 2;
#X connect 14 0 15 0;
#X connect 14 1 11 0;
#X connect 15 0 13 0;
#X connect 16 0 10 1;
#X connect 17 0 1 1;
#X connect 17 1 25 0;
#X connect 20 0 3 0;
#X connect 21 0 20 1;
#X connect 22 0 25 1;
#X connect 23 0 22 0;
#X connect 23 0 24 0;
#X connect 24 0 21 1;
#X connect 25 0 11 1;
#X connect 27 0 28 0;
